Starting orchestrator from /home/rodrigo/real_options...
2026-02-11 18:25:56,764 - Orchestrator - INFO - =============================================
2026-02-11 18:25:56,765 - Orchestrator - INFO - === Starting the Trading Bot Orchestrator ===
2026-02-11 18:25:56,766 - Orchestrator - INFO - =============================================
2026-02-11 18:25:56,768 - Orchestrator - INFO - Budget Guard initialized. Daily limit: $15.0
2026-02-11 18:25:56,769 - trading_bot.drawdown_circuit_breaker - INFO - Loaded drawdown state: NORMAL (0.00%)
2026-02-11 18:25:56,769 - Orchestrator - INFO - Drawdown Guard initialized.
2026-02-11 18:25:56,769 - Orchestrator - INFO - Expiry filter window: 45-365 DTE
2026-02-11 18:25:56,908 - Orchestrator - INFO - --- Processing Deferred Triggers ---
2026-02-11 18:25:56,908 - Orchestrator - INFO - No deferred triggers to process.
2026-02-11 18:25:56,908 - Orchestrator - INFO - Environment: DEV. Applying -30 minute 'Civil War' avoidance offset.
2026-02-11 18:25:56,911 - Orchestrator - WARNING - ‚ö†Ô∏è LATE START DETECTED: 12 scheduled tasks already passed:
  - 03:00 ET: start_monitoring
  - 03:01 ET: process_deferred_triggers
  - 04:30 ET: cleanup_orphaned_theses
  - 08:00 ET: run_position_audit_cycle
  - 08:30 ET: guarded_generate_orders
  - 10:30 ET: close_stale_positions
  - 10:45 ET: run_position_audit_cycle
  - 11:15 ET: guarded_generate_orders
  - 12:15 ET: close_stale_positions_fallback
  - 12:30 ET: run_position_audit_cycle
  - 12:45 ET: emergency_hard_close
  - 13:15 ET: cancel_and_stop_monitoring
2026-02-11 18:25:56,913 - Orchestrator - INFO - --- Recovery: Evaluating 12 missed tasks ---
2026-02-11 18:25:56,913 - Orchestrator - INFO - üîÑ RECOVERY: Running missed start_monitoring (was scheduled 03:00 ET)
2026-02-11 18:25:56,913 - Orchestrator - INFO - System shutdown flag CLEARED ‚Äî new trading day beginning
2026-02-11 18:25:56,915 - Orchestrator - INFO - --- Starting position monitoring process ---
2026-02-11 18:25:56,916 - Orchestrator - INFO - Successfully started position monitor with PID: 1419964
2026-02-11 18:25:56,916 - Orchestrator - INFO - Started position monitoring service.
2026-02-11 18:25:56,920 - Orchestrator - INFO - ‚úÖ RECOVERY: start_monitoring completed
2026-02-11 18:25:56,920 - Orchestrator - INFO - ‚úÖ ALREADY RAN: process_deferred_triggers completed earlier today (before restart). Skipping re-execution.
2026-02-11 18:25:56,920 - Orchestrator - INFO - üîÑ RECOVERY: Running missed cleanup_orphaned_theses (was scheduled 04:30 ET)
2026-02-11 18:25:56,920 - Orchestrator - INFO - --- AUTOMATED THESIS CLEANUP ---
2026-02-11 18:25:56,921 - trading_bot.connection_pool - INFO - Connecting IB (cleanup) ID: 272...
2026-02-11 18:25:57,473 - trading_bot.connection_pool - INFO - IB (cleanup) connected successfully with ID 272
2026-02-11 18:25:57,529 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2026-02-11 18:25:57,748 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-11 18:25:57,883 - Orchestrator - INFO - Thesis cleanup: no orphans found
2026-02-11 18:25:57,883 - trading_bot.connection_pool - INFO - Disconnecting IB (cleanup)...
2026-02-11 18:26:00,900 - Orchestrator - INFO - ‚úÖ RECOVERY: cleanup_orphaned_theses completed
2026-02-11 18:26:00,900 - Orchestrator - INFO - üîÑ RECOVERY: Running missed run_position_audit_cycle (was scheduled 08:00 ET)
2026-02-11 18:26:00,900 - Orchestrator - INFO - --- POSITION AUDIT CYCLE (Scheduled) ---
2026-02-11 18:26:00,902 - trading_bot.connection_pool - INFO - Connecting IB (audit) ID: 233...
2026-02-11 18:26:01,023 - Orchestrator - INFO - 2026-02-11 18:26:01,021 - trading_bot.connection_pool - INFO - Connecting IB (monitor) ID: 131...
2026-02-11 18:26:01,570 - trading_bot.connection_pool - INFO - IB (audit) connected successfully with ID 233
2026-02-11 18:26:01,586 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:01,624 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-11 18:26:02,187 - Orchestrator - INFO - State stores reconciled: 0 positions across all stores
2026-02-11 18:26:02,273 - Orchestrator - INFO - 2026-02-11 18:26:02,273 - trading_bot.connection_pool - INFO - IB (monitor) connected successfully with ID 131
2026-02-11 18:26:02,286 - Orchestrator - INFO - 2026-02-11 18:26:02,286 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:02,287 - Orchestrator - INFO - 2026-02-11 18:26:02,286 - __main__ - INFO - Position monitor connected and watching open positions.
2026-02-11 18:26:02,287 - Orchestrator - INFO - 2026-02-11 18:26:02,286 - root - INFO - Starting intraday P&L monitor. Stop: 50% (Max Risk), Profit: 80% (Capture), Interval: 600s
2026-02-11 18:26:02,287 - Orchestrator - INFO - 2026-02-11 18:26:02,286 - root - INFO - Order status and execution event handlers registered.
2026-02-11 18:26:02,370 - Orchestrator - INFO - No open positions to audit.
2026-02-11 18:26:02,374 - trading_bot.connection_pool - INFO - Disconnecting IB (audit)...
2026-02-11 18:26:05,392 - Orchestrator - INFO - ‚úÖ RECOVERY: run_position_audit_cycle completed
2026-02-11 18:26:05,393 - Orchestrator - INFO - ‚úÖ ALREADY RAN: guarded_generate_orders completed earlier today (before restart). Skipping re-execution.
2026-02-11 18:26:05,393 - Orchestrator - INFO - üîÑ RECOVERY: Running missed close_stale_positions (was scheduled 10:30 ET)
2026-02-11 18:26:05,393 - OrderManager - INFO - --- Initiating position closing based on 2-day holding period ---
2026-02-11 18:26:05,394 - trading_bot.connection_pool - INFO - Connecting IB (orchestrator_orders) ID: 143...
2026-02-11 18:26:05,811 - trading_bot.connection_pool - INFO - IB (orchestrator_orders) connected successfully with ID 143
2026-02-11 18:26:05,817 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:05,817 - OrderManager - INFO - Connected to IB for closing positions (purpose: orchestrator_orders).
2026-02-11 18:26:05,918 - OrderManager - INFO - No open positions found in the IB account. Nothing to close.
2026-02-11 18:26:05,919 - trading_bot.connection_pool - INFO - Disconnecting IB (orchestrator_orders)...
2026-02-11 18:26:08,926 - Orchestrator - INFO - ‚úÖ RECOVERY: close_stale_positions completed
2026-02-11 18:26:08,926 - Orchestrator - INFO - üîÑ RECOVERY: Running missed close_stale_positions_fallback (was scheduled 12:15 ET)
2026-02-11 18:26:08,926 - Orchestrator - INFO - --- Fallback Close Attempt (12:45 ET) ---
2026-02-11 18:26:08,926 - Orchestrator - INFO - This is a retry for any positions the 11:00 primary close failed to handle.
2026-02-11 18:26:08,926 - OrderManager - INFO - --- Initiating position closing based on 2-day holding period ---
2026-02-11 18:26:08,927 - OrderManager - WARNING - close_stale_positions connection attempt 1/3 failed: Connection orchestrator_orders in backoff period. Retrying in 5.0s...
2026-02-11 18:26:08,927 - trading_bot.connection_pool - WARNING - FORCE RESETTING connection: orchestrator_orders
2026-02-11 18:26:13,933 - trading_bot.connection_pool - INFO - Connecting IB (orchestrator_orders) ID: 140...
2026-02-11 18:26:14,245 - trading_bot.connection_pool - INFO - IB (orchestrator_orders) connected successfully with ID 140
2026-02-11 18:26:14,251 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:14,252 - OrderManager - INFO - Connected to IB for closing positions (purpose: orchestrator_orders).
2026-02-11 18:26:14,353 - OrderManager - INFO - No open positions found in the IB account. Nothing to close.
2026-02-11 18:26:14,353 - trading_bot.connection_pool - INFO - Disconnecting IB (orchestrator_orders)...
2026-02-11 18:26:17,360 - Orchestrator - INFO - ‚úÖ RECOVERY: close_stale_positions_fallback completed
2026-02-11 18:26:17,361 - Orchestrator - INFO - üîÑ RECOVERY: Running missed emergency_hard_close (was scheduled 12:45 ET)
2026-02-11 18:26:17,361 - Orchestrator - INFO - --- Emergency Hard Close Check (T-45 min) ---
2026-02-11 18:26:17,361 - Orchestrator - CRITICAL - Emergency hard close FAILED entirely: Connection orchestrator_orders in backoff period
2026-02-11 18:26:17,696 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-11 18:26:17,701 - Orchestrator - INFO - ‚úÖ RECOVERY: emergency_hard_close completed
2026-02-11 18:26:17,701 - Orchestrator - INFO - ‚úÖ ALREADY RAN: cancel_and_stop_monitoring completed earlier today (before restart). Skipping re-execution.
2026-02-11 18:26:17,702 - Orchestrator - INFO - System restarted with 9 missed tasks.
‚úÖ 6 recovered | ‚è≠Ô∏è 0 skipped | ‚úîÔ∏è 3 already ran
2026-02-11 18:26:17,924 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-11 18:26:18,311 - Orchestrator - INFO - Running TopicDiscoveryAgent on startup...
2026-02-11 18:26:18,370 - trading_bot.topic_discovery - INFO - Starting Topic Discovery Scan...
2026-02-11 18:26:31,634 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-11 18:26:31,638 - Orchestrator - INFO - Startup TopicDiscovery: 3 topics, No changes
2026-02-11 18:26:31,639 - Orchestrator - INFO - Next task 'log_equity_snapshot' scheduled for 2026-02-11 18:35:00 UTC. Waiting for 0.14 hours.
2026-02-11 18:26:31,640 - Orchestrator - INFO - --- Starting Sentinel Array ---
2026-02-11 18:26:31,640 - trading_bot.sentinels - INFO - WeatherSentinel: Loaded 11 active alerts from disk (normalized from 11)
2026-02-11 18:26:31,734 - trading_bot.sentinels - INFO - LogisticsSentinel: Generated 5 RSS URLs for Coffee (Arabica)
2026-02-11 18:26:31,734 - trading_bot.sentinels - INFO - LogisticsSentinel initialized with model: gemini-3-flash-preview | 5 RSS feeds | Commodity: Coffee (Arabica)
2026-02-11 18:26:31,841 - trading_bot.sentinels - INFO - NewsSentinel: Generated 5 RSS URLs for Coffee (Arabica)
2026-02-11 18:26:31,841 - trading_bot.sentinels - INFO - NewsSentinel initialized with model: gemini-3-flash-preview | 5 RSS feeds | Threshold: 8 | Commodity: Coffee (Arabica)
2026-02-11 18:26:31,885 - trading_bot.sentinels - INFO - XSentimentSentinel: Loaded volume baseline (mean=8.1, n=16)
2026-02-11 18:26:31,885 - trading_bot.sentinels - INFO - XSentimentSentinel initialized with model: grok-4-1-fast-reasoning
2026-02-11 18:26:31,885 - trading_bot.sentinels - INFO - Loaded state for 5 prediction market topics
2026-02-11 18:26:31,886 - trading_bot.sentinels - WARNING - Stale/misaligned slug for 'Federal Reserve Interest Rate': title='Fed Test'. Clearing cache.
2026-02-11 18:26:31,886 - trading_bot.sentinels - INFO - Reloading prediction market topics...
2026-02-11 18:26:31,887 - trading_bot.sentinels - INFO - Pruning orphaned cache entry: 'Test topic'
2026-02-11 18:26:31,890 - trading_bot.sentinels - INFO - Pruned 1 orphaned cache entries
2026-02-11 18:26:31,891 - trading_bot.sentinels - INFO - Topics reloaded: 3
2026-02-11 18:26:31,891 - trading_bot.sentinels - INFO - PredictionMarketSentinel v2.0 initialized: 3 topics
2026-02-11 18:26:32,028 - Orchestrator - INFO - Market Open: Establishing Sentinel IB connection...
2026-02-11 18:26:32,028 - trading_bot.connection_pool - INFO - Connecting IB (sentinel) ID: 113...
2026-02-11 18:26:32,028 - trading_bot.self_healing - INFO - Self-Healing Monitor started
2026-02-11 18:26:32,454 - trading_bot.connection_pool - INFO - IB (sentinel) connected successfully with ID 113
2026-02-11 18:26:32,458 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:32,458 - Orchestrator - INFO - Sentinel IB connected and injected into PriceSentinel.
2026-02-11 18:26:32,459 - root - INFO - Fetching 1 active futures contracts for KC on NYBOT...
2026-02-11 18:26:32,634 - root - INFO - Skipping contract KCH6 (Exp: 20260319): Expires < 45 days.
2026-02-11 18:26:32,634 - root - INFO - Found 10 active tradeable contracts (>=45d exp). Returning the first 1.
2026-02-11 18:26:32,635 - Orchestrator - INFO - Refreshed contract cache: KCK6
2026-02-11 18:26:32,635 - Orchestrator - INFO - Market Open: Engaging Microstructure Sentinel
2026-02-11 18:26:32,635 - trading_bot.connection_pool - INFO - Connecting IB (microstructure) ID: 205...
2026-02-11 18:26:32,995 - trading_bot.connection_pool - INFO - IB (microstructure) connected successfully with ID 205
2026-02-11 18:26:33,000 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-11 18:26:33,001 - trading_bot.microstructure_sentinel - INFO - MicrostructureSentinel initialized
2026-02-11 18:26:35,008 - trading_bot.microstructure_sentinel - INFO - Subscribed to microstructure for KCK6
2026-02-11 18:26:35,490 - ib_insync.wrapper - ERROR - Error 162, reqId 4: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:26:35,598 - ib_insync.wrapper - ERROR - Error 162, reqId 5: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:26:35,603 - Orchestrator - INFO - Checking WeatherSentinel...
2026-02-11 18:26:38,514 - ib_insync.wrapper - ERROR - Error 10197, reqId 3: No market data during competing live session, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:26:40,785 - Orchestrator - INFO - WeatherSentinel: no trigger
2026-02-11 18:26:40,789 - Orchestrator - INFO - Checking LogisticsSentinel...
2026-02-11 18:26:41,347 - Orchestrator - INFO - LogisticsSentinel: no trigger
2026-02-11 18:26:41,352 - Orchestrator - INFO - Checking NewsSentinel...
2026-02-11 18:26:42,050 - trading_bot.rate_limiter - INFO - GlobalRateLimiter initialized: ['gemini', 'openai', 'anthropic', 'xai']
2026-02-11 18:26:43,998 - Orchestrator - INFO - NewsSentinel: no trigger
2026-02-11 18:26:44,005 - Orchestrator - INFO - Checking XSentimentSentinel...
2026-02-11 18:27:16,345 - Orchestrator - INFO - XSentimentSentinel: no trigger (checks_today=1)
2026-02-11 18:27:16,349 - Orchestrator - INFO - Checking PredictionMarketSentinel...
2026-02-11 18:27:16,603 - trading_bot.sentinels - WARNING - Error processing prediction market topic 'Fed decisions (Dec-Mar)': send_pushover_notification() got an unexpected keyword argument 'priority'
2026-02-11 18:27:17,263 - trading_bot.sentinels - WARNING - Error processing prediction market topic 'How many Fed rate cuts in 2026?': send_pushover_notification() got an unexpected keyword argument 'priority'
2026-02-11 18:27:17,268 - Orchestrator - INFO - PredictionMarketSentinel: no trigger
2026-02-11 18:27:17,271 - Orchestrator - INFO - Checking MacroContagionSentinel...
2026-02-11 18:27:17,967 - Orchestrator - INFO - MacroContagionSentinel: trigger detected (source=MacroContagionSentinel, severity=7)
2026-02-11 18:27:17,967 - Orchestrator - INFO - MacroContagionSentinel cooldown active until 2026-02-11 18:27:33.445357. Skipping.
2026-02-11 18:28:18,123 - ib_insync.wrapper - ERROR - Error 162, reqId 6: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:28:18,233 - ib_insync.wrapper - ERROR - Error 162, reqId 7: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:29:18,432 - ib_insync.wrapper - ERROR - Error 162, reqId 8: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
2026-02-11 18:29:18,541 - ib_insync.wrapper - ERROR - Error 162, reqId 9: Historical Market Data Service error message:Trading TWS session is connected from a different IP address, contract: Contract(secType='FUT', conId=634760204, symbol='KC', lastTradeDateOrContractMonth='20260518', multiplier='37500', exchange='NYBOT', currency='USD', localSymbol='KCK6', tradingClass='KC')
