Starting orchestrator from /home/rodrigo/real_options...
2026-02-12 18:41:58,750 - Orchestrator - INFO - =============================================
2026-02-12 18:41:58,750 - Orchestrator - INFO - === Starting the Trading Bot Orchestrator ===
2026-02-12 18:41:58,750 - Orchestrator - INFO - =============================================
2026-02-12 18:41:58,752 - ConfigLoader - INFO - Config loaded successfully. Mode: LIVE. Providers: gemini, anthropic, openai, xai
2026-02-12 18:41:58,752 - Orchestrator - WARNING - ============================================================
2026-02-12 18:41:58,752 - Orchestrator - WARNING -   IB GATEWAY: REMOTE (100.102.50.16)
2026-02-12 18:41:58,752 - Orchestrator - WARNING -   Client IDs: DEV range (10-79)
2026-02-12 18:41:58,752 - Orchestrator - WARNING -   Trading Mode: LIVE
2026-02-12 18:41:58,752 - Orchestrator - WARNING - ============================================================
2026-02-12 18:41:58,752 - Orchestrator - CRITICAL - SAFETY: Remote gateway with TRADING_MODE=LIVE! Set TRADING_MODE=OFF in .env for dev environments.
2026-02-12 18:41:58,945 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:41:58,949 - Orchestrator - INFO - Budget Guard initialized. Daily limit: $15.0
2026-02-12 18:41:58,950 - trading_bot.drawdown_circuit_breaker - INFO - Loaded drawdown state: NORMAL (0.00%)
2026-02-12 18:41:58,950 - Orchestrator - INFO - Drawdown Guard initialized.
2026-02-12 18:41:58,950 - Orchestrator - INFO - Expiry filter window: 45-365 DTE
2026-02-12 18:41:59,100 - Orchestrator - INFO - --- Processing Deferred Triggers ---
2026-02-12 18:41:59,100 - Orchestrator - INFO - No deferred triggers to process.
2026-02-12 18:41:59,100 - Orchestrator - INFO - Environment: DEV. Applying 0 minute 'Civil War' avoidance offset.
2026-02-12 18:41:59,105 - Orchestrator - WARNING - ‚ö†Ô∏è LATE START DETECTED: 11 scheduled tasks already passed:
  - 03:30 ET: start_monitoring
  - 03:31 ET: process_deferred_triggers
  - 05:00 ET: cleanup_orphaned_theses
  - 08:30 ET: run_position_audit_cycle
  - 09:00 ET: guarded_generate_orders
  - 11:00 ET: close_stale_positions
  - 11:15 ET: run_position_audit_cycle
  - 11:45 ET: guarded_generate_orders
  - 12:45 ET: close_stale_positions_fallback
  - 13:00 ET: run_position_audit_cycle
  - 13:15 ET: emergency_hard_close
2026-02-12 18:41:59,106 - Orchestrator - INFO - --- Recovery: Evaluating 11 missed tasks ---
2026-02-12 18:41:59,106 - Orchestrator - INFO - üîÑ RECOVERY: Running missed start_monitoring (was scheduled 03:30 ET)
2026-02-12 18:41:59,107 - Orchestrator - INFO - System shutdown flag CLEARED ‚Äî new trading day beginning
2026-02-12 18:41:59,108 - Orchestrator - INFO - --- Starting position monitoring process ---
2026-02-12 18:41:59,109 - Orchestrator - INFO - Successfully started position monitor with PID: 1511496
2026-02-12 18:41:59,109 - Orchestrator - INFO - Started position monitoring service.
2026-02-12 18:41:59,112 - Orchestrator - INFO - ‚úÖ RECOVERY: start_monitoring completed
2026-02-12 18:41:59,112 - Orchestrator - INFO - ‚úÖ ALREADY RAN: process_deferred_triggers completed earlier today (before restart). Skipping re-execution.
2026-02-12 18:41:59,112 - Orchestrator - INFO - üîÑ RECOVERY: Running missed cleanup_orphaned_theses (was scheduled 05:00 ET)
2026-02-12 18:41:59,112 - Orchestrator - INFO - --- AUTOMATED THESIS CLEANUP ---
2026-02-12 18:41:59,113 - trading_bot.connection_pool - INFO - Connecting IB (cleanup) ID: 73 [REMOTE]...
2026-02-12 18:41:59,290 - trading_bot.connection_pool - INFO - IB (cleanup) connected successfully with ID 73
2026-02-12 18:41:59,347 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2026-02-12 18:41:59,483 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-12 18:41:59,611 - Orchestrator - INFO - Thesis cleanup: no orphans found
2026-02-12 18:41:59,611 - trading_bot.connection_pool - INFO - Disconnecting IB (cleanup)...
2026-02-12 18:42:02,626 - Orchestrator - INFO - ‚úÖ RECOVERY: cleanup_orphaned_theses completed
2026-02-12 18:42:02,626 - Orchestrator - INFO - üîÑ RECOVERY: Running missed run_position_audit_cycle (was scheduled 08:30 ET)
2026-02-12 18:42:02,626 - Orchestrator - INFO - --- POSITION AUDIT CYCLE (Scheduled) ---
2026-02-12 18:42:02,626 - trading_bot.connection_pool - INFO - Connecting IB (audit) ID: 56 [REMOTE]...
2026-02-12 18:42:03,054 - trading_bot.connection_pool - INFO - IB (audit) connected successfully with ID 56
2026-02-12 18:42:03,069 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:03,113 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-12 18:42:03,138 - Orchestrator - INFO - State stores reconciled: 0 positions across all stores
2026-02-12 18:42:03,141 - Orchestrator - INFO - No open positions to audit.
2026-02-12 18:42:03,143 - trading_bot.connection_pool - INFO - Disconnecting IB (audit)...
2026-02-12 18:42:03,405 - Orchestrator - INFO - 2026-02-12 18:42:03,405 - ConfigLoader - INFO - Config loaded successfully. Mode: LIVE. Providers: gemini, anthropic, openai, xai
2026-02-12 18:42:03,406 - Orchestrator - INFO - 2026-02-12 18:42:03,406 - trading_bot.connection_pool - INFO - Connecting IB (monitor) ID: 29 [REMOTE]...
2026-02-12 18:42:03,526 - Orchestrator - INFO - 2026-02-12 18:42:03,526 - trading_bot.connection_pool - INFO - IB (monitor) connected successfully with ID 29
2026-02-12 18:42:03,538 - Orchestrator - INFO - 2026-02-12 18:42:03,538 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:03,539 - Orchestrator - INFO - 2026-02-12 18:42:03,538 - __main__ - INFO - Position monitor connected and watching open positions.
2026-02-12 18:42:03,539 - Orchestrator - INFO - 2026-02-12 18:42:03,538 - root - INFO - Starting intraday P&L monitor. Stop: 50% (Max Risk), Profit: 80% (Capture), Interval: 600s
2026-02-12 18:42:03,539 - Orchestrator - INFO - 2026-02-12 18:42:03,538 - root - INFO - Order status and execution event handlers registered.
2026-02-12 18:42:06,168 - Orchestrator - INFO - ‚úÖ RECOVERY: run_position_audit_cycle completed
2026-02-12 18:42:06,168 - Orchestrator - INFO - ‚úÖ ALREADY RAN: guarded_generate_orders completed earlier today (before restart). Skipping re-execution.
2026-02-12 18:42:06,168 - Orchestrator - INFO - üîÑ RECOVERY: Running missed close_stale_positions (was scheduled 11:00 ET)
2026-02-12 18:42:06,168 - OrderManager - INFO - --- Initiating position closing based on 2-day holding period ---
2026-02-12 18:42:06,181 - trading_bot.connection_pool - INFO - Connecting IB (orchestrator_orders) ID: 30 [REMOTE]...
2026-02-12 18:42:06,602 - trading_bot.connection_pool - INFO - IB (orchestrator_orders) connected successfully with ID 30
2026-02-12 18:42:06,615 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:06,615 - OrderManager - INFO - Connected to IB for closing positions (purpose: orchestrator_orders).
2026-02-12 18:42:06,717 - OrderManager - INFO - No open positions found in the IB account. Nothing to close.
2026-02-12 18:42:06,717 - trading_bot.connection_pool - INFO - Disconnecting IB (orchestrator_orders)...
2026-02-12 18:42:09,724 - Orchestrator - INFO - ‚úÖ RECOVERY: close_stale_positions completed
2026-02-12 18:42:09,724 - Orchestrator - INFO - üîÑ RECOVERY: Running missed close_stale_positions_fallback (was scheduled 12:45 ET)
2026-02-12 18:42:09,724 - Orchestrator - INFO - --- Fallback Close Attempt (12:45 ET) ---
2026-02-12 18:42:09,725 - Orchestrator - INFO - This is a retry for any positions the 11:00 primary close failed to handle.
2026-02-12 18:42:09,725 - OrderManager - INFO - --- Initiating position closing based on 2-day holding period ---
2026-02-12 18:42:09,732 - OrderManager - WARNING - close_stale_positions connection attempt 1/3 failed: Connection orchestrator_orders in backoff period. Retrying in 5.0s...
2026-02-12 18:42:09,732 - trading_bot.connection_pool - WARNING - FORCE RESETTING connection: orchestrator_orders
2026-02-12 18:42:14,734 - trading_bot.connection_pool - INFO - Connecting IB (orchestrator_orders) ID: 30 [REMOTE]...
2026-02-12 18:42:15,053 - trading_bot.connection_pool - INFO - IB (orchestrator_orders) connected successfully with ID 30
2026-02-12 18:42:15,058 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:15,058 - OrderManager - INFO - Connected to IB for closing positions (purpose: orchestrator_orders).
2026-02-12 18:42:15,061 - OrderManager - INFO - No open positions found in the IB account. Nothing to close.
2026-02-12 18:42:15,061 - trading_bot.connection_pool - INFO - Disconnecting IB (orchestrator_orders)...
2026-02-12 18:42:18,068 - Orchestrator - INFO - ‚úÖ RECOVERY: close_stale_positions_fallback completed
2026-02-12 18:42:18,068 - Orchestrator - INFO - üîÑ RECOVERY: Running missed emergency_hard_close (was scheduled 13:15 ET)
2026-02-12 18:42:18,068 - Orchestrator - INFO - --- Emergency Hard Close Check (T-45 min) ---
2026-02-12 18:42:18,068 - Orchestrator - CRITICAL - Emergency hard close FAILED entirely: Connection orchestrator_orders in backoff period
2026-02-12 18:42:18,291 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:42:18,298 - Orchestrator - INFO - ‚úÖ RECOVERY: emergency_hard_close completed
2026-02-12 18:42:18,298 - Orchestrator - INFO - System restarted with 8 missed tasks.
‚úÖ 6 recovered | ‚è≠Ô∏è 0 skipped | ‚úîÔ∏è 2 already ran
2026-02-12 18:42:18,544 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:42:19,014 - Orchestrator - INFO - Running TopicDiscoveryAgent on startup...
2026-02-12 18:42:19,087 - trading_bot.topic_discovery - INFO - Starting Topic Discovery Scan...
2026-02-12 18:42:32,012 - trading_bot.tms - INFO - TMS initialized at ./data/tms
2026-02-12 18:42:32,014 - Orchestrator - INFO - Startup TopicDiscovery: 3 topics, No changes
2026-02-12 18:42:32,015 - Orchestrator - INFO - Next task 'cancel_and_stop_monitoring' scheduled for 2026-02-12 18:45:00 UTC. Waiting for 0.04 hours.
2026-02-12 18:42:32,016 - Orchestrator - INFO - --- Starting Sentinel Array ---
2026-02-12 18:42:32,372 - Orchestrator - INFO - Market Open: Establishing Sentinel IB connection...
2026-02-12 18:42:32,373 - trading_bot.connection_pool - INFO - Connecting IB (sentinel) ID: 16 [REMOTE]...
2026-02-12 18:42:32,373 - trading_bot.self_healing - INFO - Self-Healing Monitor started
2026-02-12 18:42:32,804 - trading_bot.connection_pool - INFO - IB (sentinel) connected successfully with ID 16
2026-02-12 18:42:32,811 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:32,811 - Orchestrator - INFO - Sentinel IB connected and injected into PriceSentinel.
2026-02-12 18:42:32,811 - root - INFO - Fetching 1 active futures contracts for KC on NYBOT...
2026-02-12 18:42:32,813 - ConfigLoader - INFO - Config loaded successfully. Mode: LIVE. Providers: gemini, anthropic, openai, xai
2026-02-12 18:42:32,950 - root - INFO - Skipping contract KCH6 (Exp: 20260319): Expires < 45 days.
2026-02-12 18:42:32,951 - root - INFO - Found 10 active tradeable contracts (>=45d exp). Returning the first 1.
2026-02-12 18:42:32,951 - Orchestrator - INFO - Refreshed contract cache: KCK6
2026-02-12 18:42:32,951 - Orchestrator - INFO - Market Open: Engaging Microstructure Sentinel
2026-02-12 18:42:32,952 - trading_bot.connection_pool - INFO - Connecting IB (microstructure) ID: 47 [REMOTE]...
2026-02-12 18:42:33,176 - trading_bot.connection_pool - INFO - IB (microstructure) connected successfully with ID 47
2026-02-12 18:42:33,182 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:42:40,540 - Orchestrator - INFO - WeatherSentinel: trigger detected (source=WeatherSentinel, severity=7)
2026-02-12 18:42:40,553 - Orchestrator - INFO - Emergency cycle BLOCKED (daily trading cutoff 12:15 ET): WeatherSentinel ‚Äî deferring to tomorrow
2026-02-12 18:42:40,555 - trading_bot.state_manager - INFO - Queued deferred trigger from WeatherSentinel
2026-02-12 18:42:40,782 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:42:42,363 - trading_bot.rate_limiter - INFO - GlobalRateLimiter initialized: ['gemini', 'openai', 'anthropic', 'xai']
2026-02-12 18:43:12,341 - Orchestrator - INFO - XSentimentSentinel: trigger detected (severity=6)
2026-02-12 18:43:12,353 - Orchestrator - INFO - Emergency cycle BLOCKED (daily trading cutoff 12:15 ET): XSentimentSentinel ‚Äî deferring to tomorrow
2026-02-12 18:43:12,355 - trading_bot.state_manager - INFO - Queued deferred trigger from XSentimentSentinel
2026-02-12 18:43:12,554 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:43:25,184 - Orchestrator - INFO - MacroContagionSentinel: trigger detected (source=MacroContagionSentinel, severity=9)
2026-02-12 18:43:25,199 - Orchestrator - INFO - Emergency cycle BLOCKED (daily trading cutoff 12:15 ET): MacroContagionSentinel ‚Äî deferring to tomorrow
2026-02-12 18:43:25,201 - trading_bot.state_manager - INFO - Queued deferred trigger from MacroContagionSentinel
2026-02-12 18:43:25,399 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-12 18:45:00,026 - Orchestrator - INFO - --- Running scheduled task: cancel_and_stop_monitoring ---
2026-02-12 18:45:00,029 - Orchestrator - INFO - --- Initiating end-of-day shutdown sequence ---
2026-02-12 18:45:00,029 - Orchestrator - INFO - System shutdown flag SET ‚Äî no new trades or emergency cycles will be processed
2026-02-12 18:45:00,030 - OrderManager - INFO - --- Canceling any remaining open DAY orders ---
2026-02-12 18:45:00,030 - trading_bot.connection_pool - INFO - Connecting IB (orchestrator_orders) ID: 32 [REMOTE]...
2026-02-12 18:45:00,445 - trading_bot.connection_pool - INFO - IB (orchestrator_orders) connected successfully with ID 32
2026-02-12 18:45:00,449 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-12 18:45:00,450 - OrderManager - INFO - Connected to IB for canceling open orders (purpose: orchestrator_orders).
2026-02-12 18:45:00,551 - OrderManager - INFO - No open orders found to cancel.
2026-02-12 18:45:00,552 - trading_bot.connection_pool - INFO - Disconnecting IB (orchestrator_orders)...
2026-02-12 18:45:03,555 - Orchestrator - INFO - --- Stopping position monitoring process (PID: 1511496) ---
2026-02-12 18:45:03,557 - Orchestrator - INFO - 2026-02-12 18:45:03,556 - __main__ - INFO - Received shutdown signal: SIGTERM. Disconnecting from IB...
2026-02-12 18:45:06,562 - Orchestrator - INFO - 2026-02-12 18:45:06,562 - root - INFO - P&L monitoring task was cancelled.
2026-02-12 18:45:06,563 - Orchestrator - INFO - 2026-02-12 18:45:06,562 - root - INFO - Shutting down monitor. Unregistering event handlers and cancelling PnL subscriptions.
2026-02-12 18:45:06,563 - Orchestrator - INFO - 2026-02-12 18:45:06,562 - __main__ - INFO - Position monitor has shut down.
2026-02-12 18:45:07,263 - Orchestrator - INFO - Position monitoring process has been successfully terminated.
2026-02-12 18:45:07,646 - Orchestrator - INFO - Connection pool released ‚Äî no stale connections for Gateway restart
2026-02-12 18:45:07,647 - Orchestrator - INFO - --- End-of-day shutdown sequence complete ---
2026-02-12 18:45:07,653 - Orchestrator - INFO - Next task 'log_equity_snapshot' scheduled for 2026-02-12 19:05:00 UTC. Waiting for 0.33 hours.
2026-02-12 18:45:25,527 - Orchestrator - INFO - Shutdown: Gracefully disengaging Microstructure Sentinel
