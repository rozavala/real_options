2026-02-26 17:51:48,375 - Engine.KC - INFO - =============================================
2026-02-26 17:51:48,375 - Engine.KC - INFO - === Starting CommodityEngine [KC] ===
2026-02-26 17:51:48,375 - Engine.KC - INFO - =============================================
2026-02-26 17:51:48,375 - Engine.KC - INFO - Data directory: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,375 - trading_bot.state_manager - INFO - StateManager data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,375 - trading_bot.task_tracker - INFO - TaskTracker data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.decision_signals - INFO - DecisionSignals data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - OrderManager - INFO - OrderManager capital state dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.sentinel_stats - INFO - SentinelStats data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.utils - INFO - Utils data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.tms - INFO - TMS default path set to: /home/rodrigo/real_options/data/KC/tms
2026-02-26 17:51:48,376 - trading_bot.brier_bridge - INFO - BrierBridge data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.brier_scoring - INFO - BrierScoring data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,376 - trading_bot.weighted_voting - INFO - WeightedVoting data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,377 - trading_bot.router_metrics - INFO - RouterMetrics data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,377 - trading_bot.agents - INFO - Agents provenance log set to: /home/rodrigo/real_options/data/KC/research_provenance.log
2026-02-26 17:51:48,377 - trading_bot.prompt_trace - INFO - PromptTrace data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,380 - trading_bot.data_dir_context - INFO - Engine data_dir set to: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,380 - trading_bot.data_dir_context - INFO - Legacy data directories configured for: /home/rodrigo/real_options/data/KC
2026-02-26 17:51:48,385 - trading_bot.drawdown_circuit_breaker - INFO - Loaded drawdown state: NORMAL (0.00%)
2026-02-26 17:51:48,385 - trading_bot.data_dir_context - INFO - EngineRuntime set for [KC]
2026-02-26 17:51:48,385 - Engine.KC - WARNING - ============================================================
2026-02-26 17:51:48,385 - Engine.KC - WARNING -   IB GATEWAY: REMOTE/PAPER (100.102.50.16)
2026-02-26 17:51:48,385 - Engine.KC - WARNING -   Client IDs: DEV range (10-79)
2026-02-26 17:51:48,385 - Engine.KC - WARNING -   Trading Mode: LIVE
2026-02-26 17:51:48,385 - Engine.KC - WARNING - ============================================================
2026-02-26 17:51:48,385 - Engine.KC - INFO - Budget Guard initialized. Daily limit: $15.0
2026-02-26 17:51:48,385 - Engine.KC - INFO - Drawdown Guard initialized.
2026-02-26 17:51:48,385 - Engine.KC - INFO - Expiry filter window: 45-365 DTE
2026-02-26 17:51:48,499 - Orchestrator - INFO - --- Processing Deferred Triggers ---
2026-02-26 17:51:48,503 - Orchestrator - INFO - Processing 1 deferred triggers from overnight
2026-02-26 17:51:48,504 - trading_bot.connection_pool - INFO - Connecting IB (KC_deferred) ID: 95 [REMOTE/PAPER]...
2026-02-26 17:51:48,667 - trading_bot.connection_pool - INFO - IB (KC_deferred) connected successfully with ID 95
2026-02-26 17:51:48,671 - Orchestrator - INFO - Duplicate trigger detected: dc552eb6
2026-02-26 17:51:48,671 - Orchestrator - INFO - Skipping deferred trigger (deduplicated): XSentimentSentinel
2026-02-26 17:51:48,671 - Orchestrator - INFO - Deferred triggers complete: 0 processed, 1 skipped, 0 rejected (contaminated)
2026-02-26 17:51:48,671 - trading_bot.connection_pool - INFO - Disconnecting IB (KC_deferred)...
2026-02-26 17:51:51,673 - Orchestrator - INFO - Built session schedule: 17 tasks for KC (04:15-13:30 ET)
2026-02-26 17:51:51,674 - Engine.KC - INFO - Environment: DEV. Applying 0 minute 'Civil War' avoidance offset.
2026-02-26 17:51:51,677 - Engine.KC - WARNING - LATE START DETECTED: 8 scheduled tasks already passed:\n  - 03:30 ET: start_monitoring\n  - 03:31 ET: process_deferred_triggers\n  - 04:00 ET: cleanup_orphaned_theses\n  - 04:42 ET: signal_open\n  - 07:01 ET: signal_early\n  - 08:52 ET: audit_mid_session\n  - 09:20 ET: signal_mid\n  - 11:39 ET: signal_late
2026-02-26 17:51:51,678 - Orchestrator - INFO - --- Recovery: Evaluating 8 missed tasks ---
2026-02-26 17:51:51,678 - Orchestrator - INFO - üîÑ RECOVERY: Running missed start_monitoring [start_monitoring] (was scheduled 03:30 ET)
2026-02-26 17:51:51,678 - Orchestrator - INFO - System shutdown flag CLEARED ‚Äî new trading day beginning
2026-02-26 17:51:51,679 - Orchestrator - INFO - --- Starting position monitoring process ---
2026-02-26 17:51:51,680 - Orchestrator - INFO - Successfully started position monitor with PID: 2679033
2026-02-26 17:51:51,681 - Orchestrator - INFO - Started position monitoring service.
2026-02-26 17:51:51,683 - Orchestrator - INFO - ‚úÖ RECOVERY: start_monitoring completed
2026-02-26 17:51:55,298 - Orchestrator - INFO - 2026-02-26 17:51:55,297 - ConfigLoader - INFO - Config loaded successfully. Mode: LIVE. Providers: gemini, anthropic, openai, xai
2026-02-26 17:51:55,299 - Orchestrator - INFO - 2026-02-26 17:51:55,298 - __main__ - INFO - Position monitor connection attempt 1/5...
2026-02-26 17:51:55,300 - Orchestrator - INFO - 2026-02-26 17:51:55,300 - trading_bot.connection_pool - INFO - Connecting IB (monitor) ID: 33 [REMOTE/PAPER]...
2026-02-26 17:51:55,420 - Orchestrator - INFO - 2026-02-26 17:51:55,420 - trading_bot.connection_pool - INFO - IB (monitor) connected successfully with ID 33
2026-02-26 17:51:55,425 - Orchestrator - INFO - 2026-02-26 17:51:55,425 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-26 17:51:55,426 - Orchestrator - INFO - 2026-02-26 17:51:55,425 - __main__ - INFO - Position monitor connected and watching open positions.
2026-02-26 17:51:55,426 - Orchestrator - INFO - 2026-02-26 17:51:55,425 - root - INFO - Starting intraday P&L monitor. Stop: 50% (Max Risk), Profit: 80% (Capture), Interval: 600s
2026-02-26 17:51:55,426 - Orchestrator - INFO - 2026-02-26 17:51:55,425 - root - INFO - Order status and execution event handlers registered.
2026-02-26 17:51:55,591 - Orchestrator - INFO - 2026-02-26 17:51:55,590 - root - INFO - --- Risk Monitor: Checking 3 combo position(s) ---
2026-02-26 17:51:57,593 - Orchestrator - INFO - 2026-02-26 17:51:57,592 - root - INFO - Combo 2 Legs on LNEM6 P3000: PnL=$-43.83 | Capture: -7.2% | Risk Used: -14.4%
2026-02-26 17:51:57,593 - Orchestrator - INFO - 2026-02-26 17:51:57,592 - root - INFO - Combo 2 Legs on LNEN6 P3250: PnL=$-92.48 | Capture: -7.3% | Risk Used: -14.7%
2026-02-26 17:51:57,593 - Orchestrator - INFO - 2026-02-26 17:51:57,592 - root - INFO - Combo 2 Legs on LNEK6 P2800: PnL=$-39.61 | Capture: -6.3% | Risk Used: -12.6%
2026-02-26 17:51:57,684 - Orchestrator - INFO - üîÑ RECOVERY: Running missed process_deferred_triggers [process_deferred_triggers] (was scheduled 03:31 ET)
2026-02-26 17:51:57,686 - Orchestrator - INFO - --- Processing Deferred Triggers ---
2026-02-26 17:51:57,686 - Orchestrator - INFO - No deferred triggers to process.
2026-02-26 17:51:57,689 - Orchestrator - INFO - ‚úÖ RECOVERY: process_deferred_triggers completed
2026-02-26 17:52:03,695 - Orchestrator - INFO - üîÑ RECOVERY: Running missed cleanup_orphaned_theses [cleanup_orphaned_theses] (was scheduled 04:00 ET)
2026-02-26 17:52:03,696 - Orchestrator - INFO - --- AUTOMATED THESIS CLEANUP ---
2026-02-26 17:52:03,696 - trading_bot.connection_pool - INFO - Connecting IB (KC_cleanup) ID: 83 [REMOTE/PAPER]...
2026-02-26 17:52:04,013 - trading_bot.connection_pool - INFO - IB (KC_cleanup) connected successfully with ID 83
2026-02-26 17:52:04,035 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2026-02-26 17:52:04,121 - trading_bot.tms - INFO - TMS initialized at /home/rodrigo/real_options/data/KC/tms
2026-02-26 17:52:04,210 - Orchestrator - INFO - Thesis cleanup: no orphans found
2026-02-26 17:52:04,210 - trading_bot.connection_pool - INFO - Disconnecting IB (KC_cleanup)...
2026-02-26 17:52:07,216 - Orchestrator - INFO - ‚úÖ RECOVERY: cleanup_orphaned_theses completed
2026-02-26 17:52:13,221 - Orchestrator - INFO - ‚úÖ ALREADY RAN: signal_open completed earlier today (before restart). Skipping re-execution.
2026-02-26 17:52:13,221 - Orchestrator - INFO - ‚úÖ ALREADY RAN: signal_early completed earlier today (before restart). Skipping re-execution.
2026-02-26 17:52:13,221 - Orchestrator - INFO - üîÑ RECOVERY: Running missed audit_mid_session [run_position_audit_cycle] (was scheduled 08:52 ET)
2026-02-26 17:52:13,221 - Orchestrator - INFO - --- POSITION AUDIT CYCLE (Scheduled) ---
2026-02-26 17:52:13,222 - trading_bot.connection_pool - INFO - Connecting IB (KC_audit) ID: 67 [REMOTE/PAPER]...
2026-02-26 17:52:13,380 - trading_bot.connection_pool - INFO - IB (KC_audit) connected successfully with ID 67
2026-02-26 17:52:13,384 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-26 17:52:13,493 - OrderManager - WARNING - Cancelling orphaned catastrophe stop: order 138 (client 35, BUY KCN6 @ 285.55), ref=CATASTROPHE_38a77db1-0162-4887-a60c-e0cfbe1f621a
2026-02-26 17:52:13,493 - OrderManager - INFO - Catastrophe stop cleanup: skipped 5 stop(s) belonging to other commodities
2026-02-26 17:52:13,790 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:52:13,801 - trading_bot.tms - INFO - TMS initialized at /home/rodrigo/real_options/data/KC/tms
2026-02-26 17:52:13,801 - ib_insync.wrapper - ERROR - Error 10147, reqId 138: OrderId 138 that needs to be cancelled is not found.
2026-02-26 17:52:13,809 - Orchestrator - INFO - State stores reconciled: 0 positions across all stores
2026-02-26 17:52:13,812 - Orchestrator - INFO - No open positions to audit.
2026-02-26 17:52:13,818 - Orchestrator - WARNING - Phantom reconciliation: Found 6 phantom ledger entries (non-zero net qty, no IB position): [('e587d9b6-4695-4191-a0fa-2b187ab01fb4', 'LNEK6 P2850', 1.0), ('e587d9b6-4695-4191-a0fa-2b187ab01fb4', 'LNEK6 P2800', -1.0), ('34778437-9ac8-4fd5-b205-eb763467516d', 'LNEM6 P2950', -1.0), ('34778437-9ac8-4fd5-b205-eb763467516d', 'LNEM6 P3000', 1.0), ('8386a2a1-9fa8-40f0-b77b-196bb84ddbec', 'LNEN6 P3300', 2.0), ('8386a2a1-9fa8-40f0-b77b-196bb84ddbec', 'LNEN6 P3250', -2.0)]
2026-02-26 17:52:13,818 - Orchestrator - INFO - Phantom reconciliation: Wrote 6 synthetic close rows to ledger
2026-02-26 17:52:13,820 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis e587d9b6-4695-4191-a0fa-2b187ab01fb4
2026-02-26 17:52:13,821 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis 34778437-9ac8-4fd5-b205-eb763467516d
2026-02-26 17:52:13,821 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis 8386a2a1-9fa8-40f0-b77b-196bb84ddbec
2026-02-26 17:52:14,127 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:52:14,129 - Orchestrator - WARNING - Phantom reconciliation zeroed out 6 ledger entries (IB has zero positions)
2026-02-26 17:52:14,129 - trading_bot.connection_pool - INFO - Disconnecting IB (KC_audit)...
2026-02-26 17:52:17,215 - Orchestrator - INFO - ‚úÖ RECOVERY: audit_mid_session completed
2026-02-26 17:52:23,217 - Orchestrator - INFO - ‚úÖ ALREADY RAN: signal_mid completed earlier today (before restart). Skipping re-execution.
2026-02-26 17:52:23,217 - Orchestrator - INFO - ‚è≠Ô∏è RECOVERY SKIP: signal_late ‚Äî past cutoff (12:12 ET)
2026-02-26 17:52:23,217 - Orchestrator - INFO - System restarted with 8 missed tasks.\n‚úÖ 4 recovered | ‚è≠Ô∏è 1 skipped | ‚úîÔ∏è 3 already ran
2026-02-26 17:52:23,417 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:52:23,950 - Engine.KC - INFO - Running TopicDiscoveryAgent on startup...
2026-02-26 17:52:23,982 - trading_bot.topic_discovery - INFO - Starting Topic Discovery Scan...
2026-02-26 17:52:40,488 - trading_bot.tms - INFO - TMS initialized at /home/rodrigo/real_options/data/KC/tms
2026-02-26 17:52:40,492 - Engine.KC - INFO - Startup TopicDiscovery: 4 topics, No changes
2026-02-26 17:52:40,493 - Engine.KC - INFO - Next task 'audit_pre_close' (Audit: Pre-Close) scheduled for 2026-02-26 17:55:00 UTC. Waiting for 0.04 hours.
2026-02-26 17:52:40,493 - Orchestrator - INFO - --- Starting Sentinel Array ---
2026-02-26 17:52:40,823 - Orchestrator - INFO - Market Open: Establishing Sentinel IB connection...
2026-02-26 17:52:40,824 - trading_bot.connection_pool - INFO - Connecting IB (KC_sentinel) ID: 20 [REMOTE/PAPER]...
2026-02-26 17:52:40,824 - trading_bot.self_healing - INFO - Self-Healing Monitor started
2026-02-26 17:52:41,154 - trading_bot.connection_pool - INFO - IB (KC_sentinel) connected successfully with ID 20
2026-02-26 17:52:41,158 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-26 17:52:41,158 - Orchestrator - INFO - Sentinel IB connected and injected into PriceSentinel.
2026-02-26 17:52:41,158 - Orchestrator - INFO - SENTINEL SAFETY NET: First market-open transition ‚Äî processing deferred triggers
2026-02-26 17:52:41,160 - Orchestrator - INFO - --- Processing Deferred Triggers ---
2026-02-26 17:52:41,160 - Orchestrator - INFO - No deferred triggers to process.
2026-02-26 17:52:41,160 - root - INFO - Fetching 1 active futures contracts for KC on NYBOT...
2026-02-26 17:52:41,163 - ConfigLoader - INFO - Config loaded successfully. Mode: LIVE. Providers: gemini, anthropic, openai, xai
2026-02-26 17:52:41,224 - root - INFO - Skipping contract KCH6 (Exp: 20260319): Expires < 45 days.
2026-02-26 17:52:41,224 - root - INFO - Found 10 active tradeable contracts (>=45d exp). Returning the first 1.
2026-02-26 17:52:41,225 - Orchestrator - INFO - Refreshed contract cache: KCK6
2026-02-26 17:52:41,225 - Orchestrator - INFO - Market Open: Engaging Microstructure Sentinel
2026-02-26 17:52:41,225 - trading_bot.connection_pool - INFO - Connecting IB (KC_microstructure) ID: 55 [REMOTE/PAPER]...
2026-02-26 17:52:41,622 - trading_bot.connection_pool - INFO - IB (KC_microstructure) connected successfully with ID 55
2026-02-26 17:52:41,626 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-26 17:52:46,905 - trading_bot.rate_limiter - INFO - GlobalRateLimiter initialized: ['gemini', 'openai', 'anthropic', 'xai']
2026-02-26 17:53:10,090 - Orchestrator - INFO - XSentimentSentinel: trigger detected (severity=6)
2026-02-26 17:53:10,100 - Orchestrator - INFO - Emergency cycle BLOCKED (daily trading cutoff 12:12 ET): XSentimentSentinel ‚Äî deferring to tomorrow
2026-02-26 17:53:10,104 - trading_bot.state_manager - INFO - Queued deferred trigger from XSentimentSentinel
2026-02-26 17:53:10,292 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:55:00,001 - Engine.KC - INFO - --- Running scheduled task: audit_pre_close [run_position_audit_cycle] ---
2026-02-26 17:55:00,006 - Orchestrator - INFO - --- POSITION AUDIT CYCLE (Scheduled) ---
2026-02-26 17:55:00,007 - trading_bot.connection_pool - INFO - Connecting IB (KC_audit) ID: 66 [REMOTE/PAPER]...
2026-02-26 17:55:01,075 - trading_bot.connection_pool - INFO - IB (KC_audit) connected successfully with ID 66
2026-02-26 17:55:01,079 - trading_bot.utils - INFO - üõ†Ô∏è FORCE_DELAYED_DATA enabled: Using Delayed Market Data (Type 3)
2026-02-26 17:55:01,335 - OrderManager - WARNING - Cancelling orphaned catastrophe stop: order 138 (client 35, BUY KCN6 @ 285.55), ref=CATASTROPHE_38a77db1-0162-4887-a60c-e0cfbe1f621a
2026-02-26 17:55:01,335 - OrderManager - INFO - Catastrophe stop cleanup: skipped 5 stop(s) belonging to other commodities
2026-02-26 17:55:01,579 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:55:01,597 - trading_bot.tms - INFO - TMS initialized at /home/rodrigo/real_options/data/KC/tms
2026-02-26 17:55:01,599 - ib_insync.wrapper - ERROR - Error 10147, reqId 138: OrderId 138 that needs to be cancelled is not found.
2026-02-26 17:55:01,612 - Orchestrator - INFO - State stores reconciled: 0 positions across all stores
2026-02-26 17:55:01,860 - Orchestrator - INFO - No open positions to audit.
2026-02-26 17:55:01,867 - Orchestrator - WARNING - Phantom reconciliation: Found 6 phantom ledger entries (non-zero net qty, no IB position): [('e587d9b6-4695-4191-a0fa-2b187ab01fb4', 'LNEK6 P2850', 1.0), ('e587d9b6-4695-4191-a0fa-2b187ab01fb4', 'LNEK6 P2800', -1.0), ('34778437-9ac8-4fd5-b205-eb763467516d', 'LNEM6 P2950', -1.0), ('34778437-9ac8-4fd5-b205-eb763467516d', 'LNEM6 P3000', 1.0), ('8386a2a1-9fa8-40f0-b77b-196bb84ddbec', 'LNEN6 P3300', 2.0), ('8386a2a1-9fa8-40f0-b77b-196bb84ddbec', 'LNEN6 P3250', -2.0)]
2026-02-26 17:55:01,868 - Orchestrator - INFO - Phantom reconciliation: Wrote 6 synthetic close rows to ledger
2026-02-26 17:55:01,869 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis e587d9b6-4695-4191-a0fa-2b187ab01fb4
2026-02-26 17:55:01,870 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis 34778437-9ac8-4fd5-b205-eb763467516d
2026-02-26 17:55:01,871 - Orchestrator - INFO - Phantom reconciliation: Invalidated thesis 8386a2a1-9fa8-40f0-b77b-196bb84ddbec
2026-02-26 17:55:02,074 - notifications - INFO - Pushover chunk sent successfully (Attachment: False).
2026-02-26 17:55:02,076 - Orchestrator - WARNING - Phantom reconciliation zeroed out 6 ledger entries (IB has zero positions)
2026-02-26 17:55:02,077 - trading_bot.connection_pool - INFO - Disconnecting IB (KC_audit)...
2026-02-26 17:55:05,083 - Engine.KC - INFO - Next task 'close_stale_primary' (Close Stale: Primary) scheduled for 2026-02-26 18:05:00 UTC. Waiting for 0.17 hours.
2026-02-26 17:57:12,503 - Orchestrator - INFO - Sentinel loop heartbeat: iteration=5, market_open=True, trading_day=True
